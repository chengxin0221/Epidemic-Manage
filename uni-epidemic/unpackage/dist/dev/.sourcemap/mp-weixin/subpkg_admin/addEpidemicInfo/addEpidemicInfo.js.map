{"version":3,"sources":["uni-app:///main.js","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?a839","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?654c","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?8fad","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?14f5","uni-app:///subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?7fe7","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue?4a82"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"subpkg_admin/addEpidemicInfo/addEpidemicInfo.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./addEpidemicInfo.vue?vue&type=template&id=46e614fa&scoped=true&\"\nvar renderjs\nimport script from \"./addEpidemicInfo.vue?vue&type=script&lang=js&\"\nexport * from \"./addEpidemicInfo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./addEpidemicInfo.vue?vue&type=style&index=0&id=46e614fa&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"46e614fa\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg_admin/addEpidemicInfo/addEpidemicInfo.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addEpidemicInfo.vue?vue&type=template&id=46e614fa&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addEpidemicInfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addEpidemicInfo.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"container\">\r\n    <!-- 发布资讯页面 -->\r\n    <!-- 资讯内容填写区域 -->\r\n    <view class=\"content\">\r\n      <!-- 资讯标题填写区域 -->\r\n      <view class=\"content-item\">\r\n        标题：<input type=\"text\" placeholder=\"请输入资讯标题\" v-model=\"epidemicInfo.title\" />\r\n      </view>\r\n      <!-- 资讯封面图片 -->\r\n      <view class=\"content-item\">\r\n        封面：\r\n        <view class=\"add-img\" @click=\"addImg\">\r\n          <block v-if=\"!epidemicInfo.coverImg\">\r\n            <uni-icons type=\"plusempty\" size=\"30\"></uni-icons>请选择图片\r\n          </block>\r\n          <block v-else>\r\n            <image class=\"img\" :src=\"epidemicInfo.coverImg\"></image>\r\n          </block>\r\n        </view>\r\n      </view>\r\n      <!-- 资讯内容编辑区域 -->\r\n      <view class=\"editor-box\">\r\n        <text>资讯内容：</text>\r\n        <!-- 编辑菜单栏容器 -->\r\n        <scroll-view class=\"editor-tool-box\" scroll-x=\"true\" @tap=\"format\">\r\n          <!-- 编辑菜单栏内容 -->\r\n          <view class=\"editor-tool\">\r\n            <!-- 字体加粗 -->\r\n            <view :class=\"formats.bold ? 'ql-active' : ''\" class=\"iconfont icon-zitijiacu\" data-name=\"bold\"></view>\r\n            <!-- 字体斜体 -->\r\n            <view :class=\"formats.italic ? 'ql-active' : ''\" class=\"iconfont icon-zitixieti\" data-name=\"italic\">\r\n            </view>\r\n            <!-- 字体下划线 -->\r\n            <view :class=\"formats.underline ? 'ql-active' : ''\" class=\"iconfont icon-zitixiahuaxian\"\r\n              data-name=\"underline\"></view>\r\n            <!-- 字体删除线 -->\r\n            <view :class=\"formats.strike ? 'ql-active' : ''\" class=\"iconfont icon-zitishanchuxian\" data-name=\"strike\">\r\n            </view>\r\n            <!-- 左对齐 -->\r\n            <view :class=\"formats.align === 'left' ? 'ql-active' : ''\" class=\"iconfont icon-zuoduiqi\" data-name=\"align\"\r\n              data-value=\"left\"></view>\r\n            <!-- 居中对齐 -->\r\n            <view :class=\"formats.align === 'center' ? 'ql-active' : ''\" class=\"iconfont icon-juzhongduiqi\"\r\n              data-name=\"align\" data-value=\"center\"></view>\r\n            <!-- 右对齐 -->\r\n            <view :class=\"formats.align === 'right' ? 'ql-active' : ''\" class=\"iconfont icon-youduiqi\" data-name=\"align\"\r\n              data-value=\"right\"></view>\r\n            <!-- 左右对齐 -->\r\n            <view :class=\"formats.align === 'justify' ? 'ql-active' : ''\" class=\"iconfont icon-zuoyouduiqi\"\r\n              data-name=\"align\" data-value=\"justify\"></view>\r\n            <!-- 行高 -->\r\n            <view :class=\"formats.lineHeight ? 'ql-active' : ''\" class=\"iconfont icon-line-height\"\r\n              data-name=\"lineHeight\" data-value=\"2\"></view>\r\n            <!-- 字体间隔 -->\r\n            <view :class=\"formats.letterSpacing ? 'ql-active' : ''\" class=\"iconfont icon-Character-Spacing\"\r\n              data-name=\"letterSpacing\" data-value=\"2em\"></view>\r\n            <!-- 上外边距 -->\r\n            <view :class=\"formats.marginTop ? 'ql-active' : ''\" class=\"iconfont icon-722bianjiqi_duanqianju\"\r\n              data-name=\"marginTop\" data-value=\"20px\"></view>\r\n            <!-- 下外边距 -->\r\n            <view :class=\"formats.previewarginBottom ? 'ql-active' : ''\" class=\"iconfont icon-723bianjiqi_duanhouju\"\r\n              data-name=\"marginBottom\" data-value=\"20px\"></view>\r\n            <!-- 移除样式 -->\r\n            <view class=\"iconfont icon-clearedformat\" @tap=\"removeFormat\"></view>\r\n            <!-- 字体大小 -->\r\n            <view :class=\"formats.fontSize === '24px' ? 'ql-active' : ''\" class=\"iconfont icon-fontsize\"\r\n              data-name=\"fontSize\" data-value=\"24px\"></view>\r\n            <!-- 字体颜色 -->\r\n            <view :class=\"formats.color === '#0000ff' ? 'ql-active' : ''\" class=\"iconfont icon-text_color\"\r\n              data-name=\"color\" data-value=\"#0000ff\"></view>\r\n            <!-- 背景颜色 -->\r\n            <view :class=\"formats.backgroundColor === '#ffff7f' ? 'ql-active' : ''\" class=\"iconfont icon-fontbgcolor\"\r\n              data-name=\"backgroundColor\" data-value=\"#ffff7f\"></view>\r\n            <!-- 选择框列表 -->\r\n            <view class=\"iconfont icon--checklist\" data-name=\"list\" data-value=\"check\"></view>\r\n            <!-- 有序列表 -->\r\n            <view :class=\"formats.list === 'ordered' ? 'ql-active' : ''\" class=\"iconfont icon-youxupailie\"\r\n              data-name=\"list\" data-value=\"ordered\"></view>\r\n            <!-- 无序列表 -->\r\n            <view :class=\"formats.list === 'bullet' ? 'ql-active' : ''\" class=\"iconfont icon-wuxupailie\"\r\n              data-name=\"list\" data-value=\"bullet\"></view>\r\n            <!-- 撤销 -->\r\n            <view class=\"iconfont icon-undo\" @tap=\"undo\"></view>\r\n            <!-- 恢复 -->\r\n            <view class=\"iconfont icon-redo\" @tap=\"redo\"></view>\r\n            <!-- 缩进 -->\r\n            <view class=\"iconfont icon-outdent\" data-name=\"indent\" data-value=\"-1\"></view>\r\n            <!-- 撤销缩进 -->\r\n            <view class=\"iconfont icon-indent\" data-name=\"indent\" data-value=\"+1\"></view>\r\n            <!-- 分割线 -->\r\n            <view class=\"iconfont icon-fengexian\" @tap=\"insertDivider\"></view>\r\n            <!-- 插入图片 -->\r\n            <view class=\"iconfont icon-charutupian\" @tap=\"insertImage\"></view>\r\n            <!-- 标题1 -->\r\n            <view :class=\"formats.header === 1 ? 'ql-active' : ''\" class=\"iconfont icon-format-header-1\"\r\n              data-name=\"header\" :data-value=\"1\"></view>\r\n            <!-- 字体下标 -->\r\n            <view :class=\"formats.script === 'sub' ? 'ql-active' : ''\" class=\"iconfont icon-zitixiabiao\"\r\n              data-name=\"script\" data-value=\"sub\"></view>\r\n            <!-- 字体上标 -->\r\n            <view :class=\"formats.script === 'super' ? 'ql-active' : ''\" class=\"iconfont icon-zitishangbiao\"\r\n              data-name=\"script\" data-value=\"super\"></view>\r\n            <!-- 删除 -->\r\n            <view class=\"iconfont icon-shanchu\" @tap=\"clear\"></view>\r\n            <view :class=\"formats.direction === 'rtl' ? 'ql-active' : ''\" class=\"iconfont icon-direction-rtl\"\r\n              data-name=\"direction\" data-value=\"rtl\"></view>\r\n          </view>\r\n        </scroll-view>\r\n        <!-- editor编辑框 -->\r\n        <editor id=\"editor\" class=\"ql-container\" placeholder=\"请输入资讯内容...\" show-img-size show-img-resize\r\n          @statuschange=\"onStatusChange\" @ready=\"onEditorReady\" @input=\"onInput\"></editor>\r\n      </view>\r\n      <!-- 发布资讯按钮 -->\r\n      <button class=\"btn-submit\" @click=\"submit\">发布</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    mapState,\r\n    mapMutations\r\n  } from \"vuex\";\r\n  //导入自己封装的 mixin 模块\r\n  import editorMethods from './some-methods.js';\r\n  // 只有管理员可进入该页面\r\n  import intopageMix from '@/mixins/before-into-adminpage.js';\r\n  export default {\r\n    // 将 editorMethods 混入到当前的页面中进行使用\r\n    mixins: [editorMethods,intopageMix],\r\n    onLoad(option) {\r\n      if (option.id) {\r\n        // 进入编辑资讯状态，展示要编辑的资讯内容\r\n        console.log(option.id)\r\n        // 将要编辑的公告内容展示出来\r\n        // 浅拷贝 Object.assign(target, source1, source2); Object.assign方法用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象（target）\r\n        Object.assign(this.epidemicInfo, this.editEpidemicInfo)\r\n        // 如果原资讯的编辑者和当前用户不同则添加当前用户的用户名到编辑者中\r\n        this.epidemicInfo.editor = this.editEpidemicInfo.editor.split(',').indexOf(this.userInfo.uname) !== -1 ? this.editEpidemicInfo.editor : this.editEpidemicInfo.editor.concat(',',this.userInfo.uname)\r\n        // 解码emoji表情\r\n        this.epidemicInfo.content = uni.$uncodeUtf16(this.epidemicInfo.content)\r\n      } else if (this.lastEpidemicInfo.title) {\r\n        // 继续编辑上次未上传成功的资讯信息\r\n        // 若是跳转登录后重新编辑资讯则初始化资讯内容为刚刚写入的内容\r\n        // 浅拷贝 Object.assign(target, source1, source2); Object.assign方法用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象（target）\r\n        Object.assign(this.epidemicInfo, this.lastEpidemicInfo)\r\n        // 解码emoji表情\r\n        this.epidemicInfo.content = uni.$uncodeUtf16(this.epidemicInfo.content)\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        // 页面标题\r\n        pageName: '发布资讯',\r\n        // 资讯内容\r\n        epidemicInfo: {\r\n          id: -1,\r\n          // 当前日期\r\n          date: '',\r\n          // 资讯标题\r\n          title: '',\r\n          // 封面\r\n          coverImg: '',\r\n          // 资讯正文内容\r\n          content: '',\r\n          // 作者\r\n          author: '',\r\n          // 编辑者\r\n          editor: '',\r\n        },\r\n        // 倒计时的秒数\r\n        seconds: 3,\r\n        //选择图片后生成的临时地址数组\r\n        imglist: [],\r\n        readOnly: false,\r\n        // 编辑菜单样式\r\n        formats: {},\r\n      };\r\n    },\r\n    computed: {\r\n      // 用户信息\r\n      ...mapState('user', ['userInfo']),\r\n      // 最新资讯、上次编辑的资讯\r\n      ...mapState('home', ['lastEpidemicInfo', 'editEpidemicInfo']),\r\n    },\r\n    methods: {\r\n      // 用于更新最新资讯信息、更新上次编辑资讯内容\r\n      ...mapMutations('home', ['updateLastEpidemicInfo', 'updateEditEpidemicInfo']),\r\n      // 编辑器初始化完成时触发\r\n      onEditorReady() {\r\n        // #ifdef MP-BAIDU\r\n        this.editorCtx = requireDynamicLib('editorLib').createEditorContext('editor');\r\n        // #endif\r\n\r\n        // #ifdef APP-PLUS || H5 ||MP-WEIXIN\r\n        uni.createSelectorQuery().select('#editor').context((res) => {\r\n          this.editorCtx = res.context\r\n          // 若是跳转登录后重新编辑资讯则初始化资讯内容为刚刚写入的内容\r\n          if (this.epidemicInfo.content) {\r\n            // console.log(this.epidemicInfo.content,'--------')\r\n            this.editorCtx.setContents({\r\n              html: this.epidemicInfo.content,\r\n              fail: (err) => {\r\n                console.log(err)\r\n              }\r\n            })\r\n          }\r\n        }).exec()\r\n        // #endif\r\n      },\r\n      // 编辑器内容改变时触发\r\n      onInput() {\r\n        const that = this\r\n        that.editorCtx.getContents({\r\n          success: res => {\r\n            // 将编辑器中的内容赋值给资讯内容对象\r\n            that.epidemicInfo.content = res.html\r\n            // console.log(res.html)\r\n          },\r\n          fail: function(err) {\r\n            console.log(err)\r\n          }\r\n        })\r\n      },\r\n      // 插入图片\r\n      insertImage() {\r\n        const that = this\r\n        //从本地相册选择图片\r\n        uni.chooseImage({\r\n          count: 1, //最多可以选择的图片张数，默认9\r\n          success(res) {\r\n            // console.log(res)\r\n            that.editorCtx.insertImage({\r\n              width: '80%',\r\n              src: res.tempFilePaths[0]\r\n            })\r\n          }\r\n        })\r\n      },\r\n      // 选择封面图片\r\n      addImg() {\r\n        const that = this\r\n        uni.chooseImage({\r\n          count: 1, //最多可以选择的图片张数，默认9\r\n          success(res) {\r\n            console.log(\"封面图：\", res.tempFilePaths[0])\r\n            that.epidemicInfo.coverImg = res.tempFilePaths[0]\r\n          }\r\n        })\r\n      },\r\n      // 发布\r\n      submit() {\r\n        // 判断资讯内容对象各项内容是否为空\r\n        if (!this.epidemicInfo.content || !this.epidemicInfo.title || !this.epidemicInfo\r\n          .coverImg) return uni.$showMsg('未填写完整！')\r\n        // 标题不得含emoji\r\n        if(uni.$utf16toEntities(this.epidemicInfo.title) !== this.epidemicInfo.title) return uni.$showMsg('标题不得含emoji！')\r\n        // 获取当前日期赋值给epidemicInfo.data\r\n        this.epidemicInfo.date = uni.$getDate()\r\n        // 发布资讯的作者和编辑者 [发布者和编辑者为空时即是新发布资讯而不是编辑资讯]\r\n        if(!this.epidemicInfo.author){\r\n          this.epidemicInfo.author = this.userInfo.uname\r\n          this.epidemicInfo.editor = this.userInfo.uname\r\n        }\r\n        const that = this\r\n        uni.showModal({\r\n          title: '发布资讯',\r\n          content: '确定已经完成资讯内容的编辑吗？',\r\n          cancelText: \"取消\", // 取消按钮的文字  \r\n          confirmText: \"确认\", // 确认按钮文字 \r\n          success: function(res) {\r\n            // 选择确定按钮\r\n            if (res.confirm) {\r\n              // 上传资讯信息\r\n              that.uploadNotic()\r\n            }\r\n          }\r\n        });\r\n      },\r\n      // 上传资讯信息\r\n      async uploadNotic() {\r\n        // <img src=\"http://tmp/qecS1Ode47Ev8bd88a13a4b021660716ad2ebffc19d7.png\" width\r\n        // [\\'\\\"] 匹配一个单引号或双引号  \r\n        // ?\t匹配前面的子表达式零次或一次  \r\n        // [^\\'\\\"] 匹配未包含的任意字符  \r\n        // * 匹配前面的子表达式零次或多次\r\n        var img = this.epidemicInfo.content.match(/src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/g);\r\n        if (img !== null) {\r\n          img.forEach((item) => {\r\n            // 上传没上传过的\r\n            if (!/http:\\/\\/([^\\/]*)\\/api\\/uploads/.test(item)) {\r\n              // 获取插入图片临时地址（slice截取src=\"\"中的图片路径）\r\n              this.imglist.push(item.slice(5, -1))\r\n            }\r\n          })\r\n          console.log(this.imglist, '资讯内容中插入图片的临时地址---------');\r\n        }\r\n        // 上传资讯正文内容中的图片到后端\r\n        if (this.imglist) {\r\n          for (let i = 0; i < this.imglist.length; i++) {\r\n            // 上传图片\r\n            const up1 = await this.uploadImg(this.imglist[i])\r\n            // console.log(up1, 'up1---------------')\r\n            if (up1 === '上传失败') return uni.$showMsg('发布资讯失败！')\r\n            // 将返回的url路径替换到资讯内容中\r\n            this.epidemicInfo.content = this.epidemicInfo.content.replace(this.imglist[i], up1)\r\n          }\r\n        }\r\n        // 上传未上传过的封面图片到后端\r\n        if (!/http:\\/\\/([^\\/]*)\\/api\\/uploads/.test(this.epidemicInfo.coverImg)) {\r\n          const up2 = await this.uploadImg(this.epidemicInfo.coverImg)\r\n          // console.log(up2, 'up2-------------------')\r\n          if (up2 === '上传失败') return uni.$showMsg('发布资讯失败！')\r\n          // 将返回的url路径替换到资讯封面图片\r\n          this.epidemicInfo.coverImg = up2\r\n        }\r\n        // 将emoji表情其转成 base64\r\n        this.epidemicInfo.content = uni.$utf16toEntities(this.epidemicInfo.content)\r\n        // 保存这次发布资讯记录以防跳转登录后需重新编辑\r\n        this.updateLastEpidemicInfo(this.epidemicInfo)\r\n        console.log(this.epidemicInfo, '上传的资讯信息')\r\n        // 发布资讯内容到后端\r\n        const response = await uni.$http.post('/addEpidemicInfo', this.epidemicInfo)\r\n        if (response.statusCode !== 200) return uni.$showMsg('发布资讯失败！')\r\n        if (response.data.status === 0) {\r\n          // 清空表单数据\r\n          this.epidemicInfo = {}\r\n          // 清空编辑器内容\r\n          this.editorCtx.clear()\r\n          // 发布成功后清空上次编辑记录\r\n          this.updateLastEpidemicInfo({})\r\n          // 清空要编辑的资讯信息\r\n          this.updateEditEpidemicInfo({})\r\n          // 跳转回之前的页面\r\n          uni.navigateBack({\r\n            complete: () => {\r\n              // 显示编辑或发布成功弹窗\r\n              uni.$showMsg(response.data.message)\r\n            }\r\n          })\r\n        } else {\r\n          // 发布资讯失败原因为身份认证失败\r\n          if (response.data.message === '身份认证失败！') {\r\n            // 3秒后跳转登录\r\n            uni.$showTips()\r\n          } else {\r\n            // 其他原因导致发布资讯失败\r\n            return uni.$showMsg(response.data.message)\r\n          }\r\n        }\r\n      },\r\n      // 上传图片到后端\r\n      uploadImg(imgurl) {\r\n        const uploadUrl = uni.$http.baseUrl + '/api/uploadImg';\r\n        return new Promise((resolve, reject) => { // 实现同步操作\r\n          uni.uploadFile({\r\n            url: uploadUrl,\r\n            filePath: imgurl,\r\n            name: 'imgfile',\r\n            success: (res) => {\r\n              // 上传不成功\r\n              if (JSON.parse(res.data).status === 1) {\r\n                uni.$showMsg(JSON.parse(res.data).message);\r\n                resolve('上传失败')\r\n              } else {\r\n                // 将上传后的新地址返回\r\n                resolve(JSON.parse(res.data).imgUrl)\r\n              }\r\n            },\r\n            fail(err) {\r\n              uni.$showMsg(err.message);\r\n              console.log('上传图片到后端失败-----')\r\n              reject('上传失败')\r\n            }\r\n          });\r\n        })\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  // 编辑菜单的图标\r\n  @import \"./editor-icon.css\";\r\n\r\n  // 资讯内容填写区域\r\n  .content {\r\n    position: relative;\r\n    top: -14px;\r\n    background-color: #fff;\r\n    padding: 10px;\r\n    border-radius: 24px;\r\n\r\n    // 资讯标题填写区域\r\n    .content-item {\r\n      display: flex;\r\n      align-items: center;\r\n      margin: 14px 0;\r\n      padding: 10px;\r\n      border: 1px solid #71a3f9;\r\n      border-radius: 18px;\r\n\r\n      // 选择图片\r\n      .add-img {\r\n        width: 80%;\r\n        height: 80px;\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        // 选择的图片\r\n        .img {\r\n          width: 160px;\r\n          height: 90px;\r\n        }\r\n      }\r\n    }\r\n\r\n    // 资讯摘要内容和资讯内容编辑区域容器\r\n    .editor-box {\r\n      margin: 14px 0;\r\n      padding: 10px;\r\n      font-size: 16px;\r\n      border: 1px solid #71a3f9;\r\n      border-radius: 18px;\r\n\r\n      // 编辑菜单栏容器\r\n      .editor-tool-box {\r\n        width: 100%;\r\n        height: 86px;\r\n        overflow-x: auto;\r\n        border: 1px solid #9d9d9d;\r\n\r\n        // 编辑菜单栏内容\r\n        .editor-tool {\r\n          width: 600px;\r\n\r\n          // 菜单项被选中时的样式\r\n          .ql-active {\r\n            color: #06c;\r\n          }\r\n\r\n          // 每个菜单项的样式\r\n          .iconfont {\r\n            display: inline-block;\r\n            padding: 10px;\r\n            width: 42rpx;\r\n            cursor: pointer;\r\n            font-size: 20px;\r\n          }\r\n        }\r\n      }\r\n\r\n      // editor编辑框\r\n      .ql-container {\r\n        padding: 12px 15px;\r\n        min-height: 632px;\r\n        font-size: 16px;\r\n        line-height: 1.5;\r\n      }\r\n    }\r\n\r\n    // 发布资讯按钮\r\n    .btn-submit {\r\n      width: 40%;\r\n      position: fixed;\r\n      bottom: 30px;\r\n      right: 32%;\r\n      background-color: #d4e4ff;\r\n    }\r\n  }\r\n</style>\n","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addEpidemicInfo.vue?vue&type=style&index=0&id=46e614fa&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./addEpidemicInfo.vue?vue&type=style&index=0&id=46e614fa&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1678525185506\n      var cssReload = require(\"D:/361/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}