{"version":3,"sources":["uni-app:///main.js","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?8674","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?a7d6","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?7060","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?825e","uni-app:///subpkg/personalInfo/personalInfo.vue","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?bc2d","webpack:///D:/361/Epidemic/Epidemic-Manage/uni-epidemic/subpkg/personalInfo/personalInfo.vue?f125"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;kDAAA;;;AAGA;AACA,kH,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,qBAAD,CAAV,C;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqI;AACrI;AACgE;AACL;AACsC;;;AAGjG;AACgL;AAChL,gBAAgB,uLAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,mGAAM;AACR,EAAE,4GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,sTAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAA0qB,CAAgB,wqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC0E9rB;;;;;AAKA,yH;AACA;AACA;AACA,0CAFA;AAGA,QAHA,kBAGA,MAHA,EAGA;AACA;AACA;AACA;AACA;AACA,KAHA,MAGA;AACA;AACA;AACA;AACA,mBADA;;AAGA;AACA,aADA,IACA,EADA;AAEA;AACA;AACA;AACA;AACA;AACA,GArBA;AAsBA,MAtBA,kBAsBA;AACA;AACA,YADA;AAEA;AACA,gBAHA;AAIA;AACA,iBALA;AAMA;AACA,iBAPA;AAQA;AACA,gBATA;AAUA;AACA;AACA,eADA;AAEA,iBAFA;AAGA,gBAHA;AAIA,qBAJA;AAKA,wBALA;AAMA,mBANA;AAOA,iBAPA;AAQA,qBARA;AASA,eATA,EAXA;;AAsBA;AACA,aAvBA;AAwBA,iBAxBA;AAyBA;AACA,aA1BA;AA2BA,sBA3BA;AA4BA;AACA,aA7BA;AA8BA,iBA9BA;AA+BA;AACA,mBAhCA;AAiCA;AACA,sBAlCA;;AAoCA,GA3DA;AA4DA;AACA,uDADA,CA5DA;;AA+DA;AACA,qDADA;AAEA;AACA,mBAHA,6BAGA;AACA,4CADA,SACA,GADA;AAEA;AACA,sEAHA;AAIA,qCAJA;AAKA;AACA,iCADA;;AAGA;AACA;AACA,qBADA,CACA,OADA,IACA,EADA;AAEA;AACA;AACA;AACA;AACA,yDAfA;;;;AAmBA,8CAnBA;AAoBA;AACA,gCArBA;;;AAwBA,8CAxBA;;;AA2BA,KA9BA;AA+BA;AACA,aAhCA,uBAgCA;AACA;AACA;AACA;AACA,gBADA;AAEA;AACA;AACA;AACA;AACA,SANA;;AAQA,KA3CA;AA4CA;AACA,aA7CA,qBA6CA,MA7CA,EA6CA;AACA;AACA;AACA;AACA,wBADA;AAEA,0BAFA;AAGA,yBAHA;AAIA;AACA;AACA;AACA;AACA;AACA,aAHA,MAGA;AACA;AACA;AACA;AACA,WAbA;AAcA,cAdA,gBAcA,GAdA,EAcA;AACA;AACA;AACA,WAjBA;;AAmBA,OApBA;AAqBA,KApEA;AAqEA;AACA,aAtEA,uBAsEA;AACA;AACA;AACA;AACA;AACA,mBADA;AAEA,8BAFA;AAGA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;AACA,6BADA;;AAGA,aAJA,MAIA;AACA;AACA;AACA;AACA;AACA;AACA,SAnBA;;AAqBA,KA/FA;AAgGA;AACA,oBAjGA,8BAiGA;AACA;AACA;AACA;AACA;AACA,iBALA;AAMA,2BANA;AAOA;AACA;AACA;AACA;AAVA,0CAWA,gCAXA,QAWA,uBAXA;;AAaA;AACA,qCADA;AAEA,yCAFA;AAGA,yCAHA;AAIA,6DAJA,IAbA,SAaA,GAbA;;;AAoBA,sCApBA,iEAoBA,qBApBA;AAqBA,qCArBA;AAsBA;AACA;AACA;AACA;AACA;AACA,qCADA;;AAGA,iBALA,MAKA;AACA;AACA;AACA;AACA,iBAjCA;AAkCA,qCAlCA;;;AAqCA,8CArCA;AAsCA;AACA,gCAvCA;;;AA0CA,8CA1CA;;;AA6CA,KA9IA;AA+IA;AACA,UAhJA,oBAgJA;;AAEA,+CAFA,SAEA,GAFA;;AAIA,sCAJA,gEAIA,uBAJA;AAKA,qCALA;AAMA;AACA;AACA,iBARA,GAQA,CARA,cAQA,yBARA;AASA,iEATA;AAUA,gCAVA,6CAQA,GARA;;;;AAcA;AACA;AACA;AACA,iBAHA,MAGA;AACA;AACA;AACA,iBApBA;;AAsBA,8CAtBA;;AAwBA,KAxKA;AAyKA;AACA,mBA1KA,2BA0KA,IA1KA,EA0KA;AACA;AACA,iCADA,GADA,SACA,GADA;;;AAKA,sCALA,gEAKA,uBALA;AAMA,qCANA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA,iBAbA,GAaA,CAbA,cAaA,8BAbA;AAcA,2EAdA;AAeA,gCAfA,6CAaA,GAbA;;;;AAmBA;AACA,oEApBA;;AAsBA,8CAtBA;;AAwBA,KAlMA;AAmMA;AACA,cApMA,sBAoMA,IApMA,EAoMA;AACA;AACA,qBAFA,GAEA;AACA,oCADA;AAEA,sDAFA,EAFA;;AAMA;AACA;AACA;AACA,wDADA;;AAGA,iBAXA;AAYA,sDAZA,SAYA,GAZA;;AAcA,sCAdA,gEAcA,uBAdA;AAeA,qCAfA;AAgBA;AACA;AACA;AACA;AACA;AACA;AArBA,sBAsBA,qCAtBA;;AAwBA,iBAxBA,GAwBA,CAxBA,eAwBA,yBAxBA;AAyBA,mEAzBA;AA0BA,gCA1BA,6CAwBA,GAxBA;;;;;;AAgCA,8CAhCA;;AAkCA,KAtOA;AAuOA;AACA,aAxOA,qBAwOA,CAxOA,EAwOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAlPA;AAmPA;AACA,aApPA,qBAoPA,CApPA,EAoPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA7PA;AA8PA;AACA,aA/PA,qBA+PA,CA/PA,EA+PA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA,KAzQA;AA0QA;AACA,UA3QA,kBA2QA,IA3QA,EA2QA;AACA;AACA;AACA;AADA,WAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAvRA;AAwRA;AACA,QAzRA,kBAyRA;AACA;AACA,KA3RA,GA/DA,E;;;;;;;;;;;;;AChFA;AAAA;AAAA;AAAA;AAAiyC,CAAgB,utCAAG,EAAC,C;;;;;;;;;;;ACArzC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"subpkg/personalInfo/personalInfo.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subpkg/personalInfo/personalInfo.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./personalInfo.vue?vue&type=template&id=3bba558c&scoped=true&\"\nvar renderjs\nimport script from \"./personalInfo.vue?vue&type=script&lang=js&\"\nexport * from \"./personalInfo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./personalInfo.vue?vue&type=style&index=0&id=3bba558c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3bba558c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subpkg/personalInfo/personalInfo.vue\"\nexport default component.exports","export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./personalInfo.vue?vue&type=template&id=3bba558c&scoped=true&\"","var components\ntry {\n  components = {\n    uniIcons: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./personalInfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./personalInfo.vue?vue&type=script&lang=js&\"","<template>\r\n  <!-- 个人信息页面 -->\r\n  <view class=\"container\">\r\n    <!-- 头像和姓名模块 -->\r\n    <view class=\"img-name-box\">\r\n      <!-- 头像 -->\r\n      <view class=\"img-box\">\r\n        <image :src=\"headImg\" mode=\"widthFix\" class=\"info-img\" @click=\"changeImg\"></image>\r\n      </view>\r\n      <!-- 姓名 -->\r\n      <text class=\"name\">{{personalInfo.uname}}</text>\r\n    </view>\r\n    <!-- 个人信息模块 -->\r\n    <view class=\"info-box\">\r\n      <view class=\"info-content\">\r\n        <!-- 个人信息项 -->\r\n        <view class=\"info-item\">\r\n          姓名：<input class=\"item-text\" v-model=\"personalInfo.uname\" />\r\n        </view>\r\n        <view class=\"info-item\">\r\n          学号：<input class=\"item-text\" style=\"color: #797979;\" disabled=\"true\" v-model=\"personalInfo.uid\" />\r\n        </view>\r\n        <view class=\"info-item\" v-if=\"personalInfo.userType !== '管理员'\">\r\n          学院：<text class=\"item-text\" :style=\"{'color': !id ? '#797979' : ''}\">{{personalInfo.college}}</text>\r\n          <picker :range=\"college\" :value=\"coli\" @change=\"changeCol\" v-if=\"id && userInfo.userType === '管理员'\">\r\n            <uni-icons class=\"icon-refresh\" color=\"#20517f\" type=\"refresh\" size=\"20\"></uni-icons>\r\n          </picker>\r\n        </view>\r\n        <view class=\"info-item\" v-if=\"personalInfo.userType === '学生'\">\r\n          专业：<text class=\"item-text\" :style=\"{'color': !id ? '#797979' : ''}\">{{personalInfo.professional}}</text>\r\n          <picker :range=\"professional\" :value=\"proi\" @change=\"changePro\" v-if=\"id && userInfo.userType === '管理员'\">\r\n            <uni-icons class=\"icon-refresh\" color=\"#20517f\" type=\"refresh\" size=\"20\"></uni-icons>\r\n          </picker>\r\n        </view>\r\n        <view class=\"info-item\" v-if=\"personalInfo.userType==='学生'\">\r\n          班级：<text class=\"item-text\" :style=\"{'color': !id ? '#797979' : ''}\">{{personalInfo.className}}</text>\r\n          <picker :range=\"classes\" :value=\"clai\" @change=\"changeCla\" v-if=\"id\">\r\n            <uni-icons class=\"icon-refresh\" color=\"#20517f\" type=\"refresh\" size=\"20\"></uni-icons>\r\n          </picker>\r\n        </view>\r\n        <view class=\"info-item\" v-if=\"personalInfo.userType==='教师'\">\r\n          <text>班级：</text>\r\n          <view class=\"class-box\">\r\n            <view class=\"class-item\" v-for=\"(item,index) in classList\" :key=\"index\">{{item}}<!-- X 图标 -->\r\n              <uni-icons class=\"icon-del\" color=\"#6f6f6f\" type=\"clear\" size=\"24\" @click=\"delCla(item)\" v-if=\"id\">\r\n              </uni-icons>\r\n            </view>\r\n            <view class=\"icon-box\" v-if=\"id\">\r\n              <picker :range=\"classes\" :value=\"clai\" @change=\"changeCla\">\r\n                <!-- + 图标 -->\r\n                <uni-icons class=\"icon-add\" color=\"#20517f\" type=\"plusempty\" size=\"22\"></uni-icons>\r\n              </picker>\r\n              <uni-icons class=\"icon-redo\" color=\"#20517f\" type=\"undo\" size=\"22\" @click=\"redo\"></uni-icons>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <view class=\"info-item\" v-if=\"id\">\r\n          密码：<input class=\"item-text\" type=\"text\" v-model=\"personalInfo.upwd\" />\r\n        </view>\r\n        <view class=\"info-item\">\r\n          电话：<input class=\"item-text\" type=\"number\" maxlength=\"11\" v-model=\"personalInfo.phone\" />\r\n        </view>\r\n        <view class=\"info-item\">\r\n          户籍所在地：<input class=\"item-text\" v-model=\"personalInfo.residence\" />\r\n        </view>\r\n      </view>\r\n      <!-- 编辑按钮 -->\r\n      <button class=\"btn-submit\" @click=\"clickEdit\">编辑</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n  // 按需从 vuex 中导入 mapState 辅助函数\r\n  import {\r\n    mapState,\r\n    mapMutations\r\n  } from 'vuex';\r\n  // 导入自己封装的 mixin 模块\r\n  import intopageMix from '@/mixins/before-nologin-into-page.js';\r\n  export default {\r\n    // 未登录的用户不可进入该页面\r\n    mixins: [intopageMix],\r\n    onLoad(option) {\r\n      // 跳转不带id参数，显示登录用户的个人信息\r\n      if (!option.id) {\r\n        // 获取最新个人信息\r\n        this.getPersonalInfo()\r\n      } else if (option.id) {\r\n        this.id = option.id;\r\n        // 跳转带id参数，显示存储在store中的用户个人信息\r\n        this.personalInfo = {\r\n          ...this.userData\r\n        };\r\n        this.personalInfo.img = this.personalInfo.img ? this.personalInfo.img.replace(/http:\\/\\/([^\\/]*)/g, uni.$http\r\n          .baseUrl) : ''\r\n        this.headImg = this.personalInfo.img ? this.personalInfo.img : '../../static/girl.png'\r\n        this.classList = this.personalInfo.className ? this.personalInfo.className.split(',') : []\r\n        // 获取所有学院信息\r\n        this.getCPC();\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        id: '',\r\n        // 编辑个人信息的人\r\n        editor: '',\r\n        // 是否修改头像\r\n        cimg: false,\r\n        // 头像\r\n        headImg: '',\r\n        // 用于删除原头像\r\n        delImg: '',\r\n        // 个人信息\r\n        personalInfo: {\r\n          uid: '',\r\n          uname: '',\r\n          upwd: '',\r\n          className: '',\r\n          professional: '',\r\n          college: '',\r\n          phone: '',\r\n          residence: '',\r\n          img: ''\r\n        },\r\n        // 学院名称数组\r\n        coli: 0,\r\n        college: [],\r\n        // 专业名称数组\r\n        proi: 0,\r\n        professional: [],\r\n        // 班级名称数组 \r\n        clai: 0,\r\n        classes: [],\r\n        // 班主任管理的班级\r\n        classList: [],\r\n        // 改变学院、专业、班级\r\n        hadChange: false,\r\n      };\r\n    },\r\n    computed: {\r\n      ...mapState('user', ['userInfo', 'userData']),\r\n    },\r\n    methods: {\r\n      ...mapMutations('user', ['updateUserInfo']),\r\n      // 获取最新个人信息\r\n      async getPersonalInfo() {\r\n        const res = await uni.$http.get('/userInfo')\r\n        // 请求失败\r\n        if (res.statusCode !== 200) uni.$showMsg('获取个人信息失败！')\r\n        if (res.data.status === 0) {\r\n          this.personalInfo = {\r\n            ...res.data.userInfo\r\n          }\r\n          // console.log(res.data.userInfo,'--------')\r\n          this.personalInfo.img = this.personalInfo.img ? this.personalInfo.img.replace(/http:\\/\\/([^\\/]*)/g, uni\r\n            .$http.baseUrl) : ''\r\n          this.headImg = this.personalInfo.img ? this.personalInfo.img : '../../static/girl.png'\r\n          this.classList = this.personalInfo.className ? this.personalInfo.className.split(',') : []\r\n          if (!this.personalInfo.img) this.personalInfo.img = this.userInfo.img\r\n          // 更新内存中的个人信息\r\n          this.updateUserInfo(this.personalInfo)\r\n          return\r\n        } else {\r\n          // 编辑失败原因为身份认证失败\r\n          if (res.data.message === '身份认证失败！') {\r\n            // 3秒后跳转登录\r\n            uni.$showTips()\r\n          } else {\r\n            // 其他原因导致失败\r\n            return uni.$showMsg(res.data.message)\r\n          }\r\n        }\r\n      },\r\n      // 更改头像\r\n      changeImg() {\r\n        // 不是登录用户本人不可修改头像\r\n        if (this.id) return uni.$showMsg('用户本人才可更换头像！');\r\n        uni.chooseImage({\r\n          count: 1,\r\n          success: (res) => {\r\n            // console.log('头像', res.tempFilePaths,'-----')\r\n            this.cimg = true;\r\n            this.headImg = res.tempFilePaths[0]\r\n          }\r\n        })\r\n      },\r\n      // 上传头像\r\n      uploadImg(imgurl) {\r\n        const uploadUrl = uni.$http.baseUrl + '/api/uploadImg?type=headImg';\r\n        return new Promise((resolve, reject) => { // 实现同步操作\r\n          uni.uploadFile({\r\n            url: uploadUrl,\r\n            filePath: imgurl,\r\n            name: 'imgfile',\r\n            success: (res) => {\r\n              // 上传不成功\r\n              if (JSON.parse(res.data).status === 1) {\r\n                uni.$showMsg(JSON.parse(res.data).message);\r\n                resolve('上传失败')\r\n              } else {\r\n                // 将上传后的新地址返回\r\n                resolve(JSON.parse(res.data).imgUrl)\r\n              }\r\n            },\r\n            fail(err) {\r\n              uni.$showMsg(err.message);\r\n              reject('上传失败')\r\n            }\r\n          });\r\n        })\r\n      },\r\n      // 点击编辑按钮\r\n      clickEdit() {\r\n        if (!this.personalInfo.uname) return uni.$showMsg('姓名不可为空！')\r\n        if (this.id && !this.personalInfo.upwd) return uni.$showMsg('密码不可为空！')\r\n        // 询问用户是否要提交编辑结果\r\n        uni.showModal({\r\n          title: '提示',\r\n          content: '确认要编辑个人信息吗？',\r\n          success: (res) => {\r\n            if (res.confirm) {\r\n              // 编辑个人信息\r\n              this.editPersonalInfo()\r\n            } else {\r\n              // id为空表示显示的是登录用户的个人信息\r\n              if (!this.id) {\r\n                this.personalInfo = {\r\n                  ...this.userInfo\r\n                }\r\n              } else {\r\n                // 恢复显示原信息\r\n                this.hadChange = false\r\n                this.personalInfo = this.userData\r\n              }\r\n            }\r\n          }\r\n        })\r\n      },\r\n      // 上传编辑结果\r\n      async editPersonalInfo() {\r\n        console.log(this.userInfo, this.personalInfo, '-----')\r\n        // id不为空表示显示的是选择的用户的个人信息\r\n        if (this.id) {\r\n          this.editor = this.userInfo.userType\r\n        }\r\n        if (this.cimg) {\r\n          // 如果原头像是上传的则删除原头像\r\n          if (/http:\\/\\/([^\\/]*)\\/api\\/uploads/g.test(this.personalInfo.img)) this.delImg = this.personalInfo.img\r\n          // console.log(this.delImg,'-----------delimg')\r\n          // 修改头像\r\n          this.personalInfo.img = await this.uploadImg(this.headImg)\r\n        }\r\n        const res = await uni.$http.post('/editUserInfo', {\r\n          ...this.personalInfo,\r\n          editor: this.editor,\r\n          delImg: this.delImg,\r\n          newClassName: this.classList.toString()\r\n        })\r\n        // 请求失败\r\n        if (res.statusCode !== 200) return uni.$showMsg(\"编辑失败！\")\r\n        if (res.data.status === 0) {\r\n          this.cimg = false\r\n          // id为空表示显示的是登录用户的个人信息\r\n          if (!this.id) {\r\n            // 更新内存中的个人信息\r\n            this.updateUserInfo({\r\n              ...this.personalInfo\r\n            })\r\n          } else {\r\n            this.personalInfo.className = this.classList.toString()\r\n            // 获取所有学院信息\r\n            this.getCPC();\r\n          }\r\n          return uni.$showMsg(\"编辑成功！\")\r\n        } else {\r\n          // 编辑失败原因为身份认证失败\r\n          if (res.data.message === '身份认证失败！') {\r\n            // 3秒后跳转登录\r\n            uni.$showTips()\r\n          } else {\r\n            // 其他原因导致失败\r\n            return uni.$showMsg(res.data.message)\r\n          }\r\n        }\r\n      },\r\n      // 获取所有学院信息\r\n      async getCPC(index = 0) {\r\n        // 获取所有学院信息\r\n        const res = await uni.$http.get('/api/college')\r\n        // 请求失败\r\n        if (res.statusCode !== 200) return uni.$showMsg('获取信息失败！')\r\n        if (res.data.status === 0) {\r\n          this.college = res.data.college\r\n          // 把数组调到与当前显示用户的学院一致\r\n          for (let i = 0; i < this.college.length; i++) {\r\n            if (this.college[i] === this.personalInfo.college) {\r\n              this.coli = i\r\n              break;\r\n            }\r\n          }\r\n          if (this.personalInfo.userType !== '学生') {\r\n            // 获取某学院某专业所有班级信息\r\n            this.getClasses()\r\n          } else {\r\n            // 获取某学院所有专业信息\r\n            this.getProfessional(this.college[this.coli])\r\n          }\r\n        } else {\r\n          return uni.$showMsg(res.data.message)\r\n        }\r\n      },\r\n      // 获取某学院所有专业信息\r\n      async getProfessional(data) {\r\n        const res = await uni.$http.get('/api/professional', {\r\n          college: data\r\n        })\r\n        // 请求失败\r\n        if (res.statusCode !== 200) return uni.$showMsg('获取信息失败！')\r\n        if (res.data.status === 0) {\r\n          this.professional = res.data.professional\r\n          // 学院发生了改变更新专业数据时，改变学生的专业\r\n          if (this.hadChange && this.personalInfo.userType === '学生') {\r\n            this.personalInfo.professional = this.professional[this.proi]\r\n          }\r\n          // 把数组调到与当前显示用户的专业一致\r\n          for (let i = 0; i < this.professional.length; i++) {\r\n            if (this.professional[i] === this.personalInfo.professional) {\r\n              this.proi = i\r\n              break;\r\n            }\r\n          }\r\n          // 获取某学院某专业所有班级信息\r\n          this.getClasses(this.professional[this.proi])\r\n        } else {\r\n          return uni.$showMsg(res.data.message)\r\n        }\r\n      },\r\n      // 获取某学院某专业所有班级信息\r\n      async getClasses(data) {\r\n        // 显示学生的个人信息则获取某学院某专业的班级信息\r\n        let param = {\r\n          professional: data,\r\n          college: this.college[this.coli]\r\n        }\r\n        // 不是显示学生的个人信息则获取某个学院所有班级的信息\r\n        if (this.personalInfo.userType !== '学生') {\r\n          param = {\r\n            college: this.college[this.coli]\r\n          }\r\n        }\r\n        const res = await uni.$http.get('/api/classes', param)\r\n        // 请求失败\r\n        if (res.statusCode !== 200) return uni.$showMsg('获取信息失败！')\r\n        if (res.data.status === 0) {\r\n          this.classes = res.data.classes\r\n          // 学院或专业发生了改变更新班级数据时，改变学生的班级\r\n          if (this.hadChange && this.personalInfo.userType === '学生') {\r\n            this.personalInfo.className = this.classes[this.clai]\r\n          }\r\n          // 显示学生的个人信息则须调整班级数组\r\n          if (this.personalInfo.userType === '学生') {\r\n            // 把数组调到与当前显示用户的专业一致\r\n            for (let i = 0; i < this.classes.length; i++) {\r\n              if (this.classes[i] === this.personalInfo.className) {\r\n                this.clai = i\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        } else {\r\n          return uni.$showMsg(res.data.message)\r\n        }\r\n      },\r\n      // 学院选择项改变\r\n      changeCol(e) {\r\n        // console.log(index,'-----')\r\n        this.coli = e.detail.value;\r\n        // 标志学院发生了改变\r\n        this.hadChange = true\r\n        this.personalInfo.college = this.college[this.coli]\r\n        // 改变专业选择器\r\n        this.getProfessional(this.college[this.coli])\r\n        this.proi = 0\r\n        this.clai = 0\r\n      },\r\n      // 专业选择项改变\r\n      changePro(e) {\r\n        // console.log(index,'-----')\r\n        this.proi = e.detail.value\r\n        // 标志专业发生了改变\r\n        this.hadChange = true\r\n        this.personalInfo.professional = this.professional[this.proi]\r\n        // 改变班级选择器\r\n        this.getClasses(this.professional[this.proi])\r\n        this.clai = 0\r\n      },\r\n      // 班级选择项改变\r\n      changeCla(e) {\r\n        // console.log(index,'-----')\r\n        this.clai = e.detail.value\r\n        this.hadChange = true\r\n        if (this.personalInfo.userType === '学生') {\r\n          this.personalInfo.className = this.classes[this.clai]\r\n        } else {\r\n          this.classList.push(this.classes[this.clai])\r\n          this.classList = [...new Set(this.classList)]\r\n        }\r\n      },\r\n      // 删除添加的班级\r\n      delCla(name) {\r\n        // 是最后一个\r\n        if (name === this.classList[this.classList.length - 1]) this.classList.pop()\r\n        // 不是最后一个\r\n        else {\r\n          for (let i = 1; i < this.classList.length; i++) {\r\n            if (this.classList[i - 1] === name) {\r\n              this.classList[i - 1] = this.classList[i]\r\n            }\r\n          }\r\n          this.classList.pop()\r\n        }\r\n      },\r\n      // 恢复修改前的数据\r\n      redo() {\r\n        this.classList = this.personalInfo.className ? this.personalInfo.className.split(',') : []\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .container {\r\n\r\n    // 头像和姓名模块\r\n    .img-name-box {\r\n      height: 400rpx;\r\n      background-color: #d4e4ff;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      padding-top: 40px;\r\n\r\n      // 头像\r\n      .img-box {\r\n        width: 160rpx;\r\n        height: 160rpx;\r\n        border-radius: 50%;\r\n        overflow: hidden;\r\n        .info-img {\r\n          width: 160rpx;\r\n        }\r\n      }\r\n      // 姓名\r\n      .name {\r\n        font-size: 18px;\r\n        margin-top: 10px;\r\n      }\r\n    }\r\n\r\n    // 个人信息模块\r\n    .info-box {\r\n      .info-content {\r\n        width: 92%;\r\n        margin: 0 auto;\r\n        position: relative;\r\n        top: -129rpx;\r\n        background-color: white;\r\n        border-radius: 18px;\r\n        box-shadow: 0 4px 14px 0 rgba(0, 0, 0, 0.06);\r\n\r\n        // 个人信息项\r\n        .info-item {\r\n          display: flex;\r\n          padding: 12px 8px;\r\n          border-bottom: 1px solid #ebebeb;\r\n          font-size: 16px;\r\n\r\n          &:last-child {\r\n            border: none;\r\n          }\r\n\r\n          // 输入框\r\n          .item-text {\r\n            width: 58%;\r\n            margin-left: 6px;\r\n          }\r\n\r\n          // 班级\r\n          .class-box {\r\n            width: 74%;\r\n\r\n            // 管理班级\r\n            .class-item {\r\n              position: relative;\r\n              padding: 5px;\r\n              margin: 5px;\r\n              color: white;\r\n              display: inline-block;\r\n              border-radius: 18px;\r\n              background-color: #20517f;\r\n\r\n              // X 图标\r\n              .icon-del {\r\n                position: absolute;\r\n                right: -7px;\r\n                top: -9px;\r\n              }\r\n            }\r\n\r\n            // + 图标 redo 图标的容器\r\n            .icon-box {\r\n              display: flex;\r\n              padding-top: 6px;\r\n\r\n              // + 图标\r\n              .icon-add,\r\n              .icon-redo {\r\n                padding-left: 16px;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        .picker-view {\r\n          width: 690rpx;\r\n          height: 500rpx;\r\n          margin-top: 20rpx;\r\n        }\r\n\r\n        .item {\r\n          line-height: 100rpx;\r\n          text-align: center;\r\n        }\r\n      }\r\n\r\n      // 编辑按钮\r\n      .btn-submit {\r\n        position: relative;\r\n        top: -50rpx;\r\n        width: 80%;\r\n        background-color: #d4e4ff;\r\n      }\r\n    }\r\n  }\r\n</style>\n","import mod from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./personalInfo.vue?vue&type=style&index=0&id=3bba558c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./personalInfo.vue?vue&type=style&index=0&id=3bba558c&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1678514647031\n      var cssReload = require(\"D:/361/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}